---
import brandLogo from "../assets/brand-logo.png";
import { getLangFromUrl, useTranslations } from '../i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

//Add images as needed with src and alt attributes
---
<section id="our-clients" class="py-20 relative bg-dark-blue" >
    <div class="flex flex-col md:flex-row  w-4/5 ml-auto mr-auto sm:gap-4">
        <div class="md:flex-1/2 lg:flex-2/3">
            <h1 class="mt-4 sm:text-4xl md:text-5xl lg:text-6xl sm:text-center md:text-left font-bold text-white">Lleva tu negocio al siguiente nivel</h1>
            <h3 class="mt-4 sm:text-2xl md:text-3xl sm:text-center md:text-left text-white-blue">Software que se ajusta a tus necesidades</h3>
            <img class="lg:w-1/4 sm:w-1/4 md:w-1/2 max-h-10px mt-5 ml-auto mr-auto self-center bg-white rounded-lg" src={brandLogo.src} alt="brandLogo" />
        </div>
        <div class="md:flex-1/2 lg:flex-1/3 bg-light-gray rounded-lg  p-5 max-w-300px">
            <h3 class="text-2xl font-bold mb-5 sm:text-center">¿Listo para iniciar tu próximo proyecto?</h3>
            <form id="contact" name="contact" method="POST" netlify-honeypot="bot-field" data-netlify="true" class="flex flex-col gap-2">
                <input type="hidden" name="bot-field" />
                <input class="bg-white p-2 rounded-lg" type="text" name="name" placeholder="Nombre completo" />
                <input class="bg-white p-2 rounded-lg" type="email" name="email" placeholder="Correo electrónico" />
                <input class="bg-white p-2 rounded-lg" type="tel" pattern="/^\+?[1-9][0-9]{7,14}$/" name="telefono" placeholder="Teléfono" />
                <textarea class="bg-white p-2 rounded-lg h-25" name="message" placeholder="Descripción breve del proyecto" />
                <button class="bg-light-blue rounded-lg font-bold py-2 text-lg cursor-pointer" type="submit">Solicitar cotización</button>
            </form>
        </div>
    </div>

</section>

<script>
    import Swal from "sweetalert2";
    let form = document.getElementById("contact");
    form.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        console.log(formData);
        let valid = true;
        formData.entries().forEach((field) => {
            if (field[1] === "" && field[0] !== "bot-field") {
                Swal.fire({
                    title: "Por favor llena todos los campos del formulario",
                    icon: "error",
                    confirmButtonText: "¡Entendido!",
                })
                valid = false;
            }
        })
        if (valid) {
            fetch("/", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams(formData).toString()
            })
            .then(() => {
                Swal.fire({
                    title: "El mensaje fue enviado con éxito",
                    icon: "success",
                    confirmButtonText: "¡Entendido!",
                })
            })
            .catch(error => {
                Swal.fire({
                    title: "Hubo un error al enviar el mensaje, por favor revisa el formulario",
                    icon: "error",
                    confirmButtonText: "¡Entendido!",
                })
            });

        }
    })
</script>